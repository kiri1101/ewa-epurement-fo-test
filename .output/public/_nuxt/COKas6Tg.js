import A from"./elfJfZ2g.js";import{k as O,g as N,o as T,y as C,N as R,O as F,P as I,Q as b,R as B,S as M,l as P,m as D,r as S,u as E,n as L,f as j,p as G,c as W,a as p,t as f,d as h,b as k,h as w,s as z,v as H}from"./B5jmmgch.js";import{u as Q,_ as U}from"./DdbQpEcR.js";import{u as q}from"./DNfZ_E1e.js";import"./BXm-dGCd.js";import"./sPKYO-qt.js";import"./B7Gih5hX.js";import"./mIU_V9T5.js";import"./BybXUGIc.js";import"./SczUJWWo.js";const J=O({__name:"OtpVariant",props:{identifier:{}},setup(l){return(e,c)=>{const r=A;return T(),N(r,{name:l.identifier,variant:"filled",length:6},null,8,["name"])}}}),K=Object.assign(J,{__name:"InputOtpVariant"});function $(l,e){return B()?(M(l,e),!0):!1}const V=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;function X(l,e=1e3,c={}){const{immediate:r=!0,immediateCallback:o=!1}=c;let t=null;const a=C(!1);function u(){t&&(clearInterval(t),t=null)}function m(){a.value=!1,u()}function v(){const s=b(e);s<=0||(a.value=!0,o&&l(),u(),a.value&&(t=setInterval(l,s)))}return r&&V&&v(),(R(e)||typeof e=="function")&&$(F(e,()=>{a.value&&V&&v()})),$(m),{isActive:I(a),pause:m,resume:v}}function Y(l,e){var c,r;const o=C(b(l)),t=X(()=>{var s;const d=o.value-1;if(o.value=d<0?0:d,e==null||(s=e.onTick)===null||s===void 0||s.call(e),o.value<=0){var _;t.pause(),e==null||(_=e.onComplete)===null||_===void 0||_.call(e)}},(c=e?.interval)!==null&&c!==void 0?c:1e3,{immediate:(r=e?.immediate)!==null&&r!==void 0?r:!1}),a=s=>{var d;o.value=(d=b(s))!==null&&d!==void 0?d:b(l)},u=()=>{t.pause(),a()},m=()=>{t.isActive.value||o.value>0&&t.resume()};return{remaining:o,reset:a,stop:u,start:s=>{a(s),t.resume()},pause:t.pause,resume:m,isActive:t.isActive}}const Z={class:"mx-auto w-92"},ee={class:"pb-4 text-3xl font-bold text-center underline decoration-auth-form-title-decoration decoration-2 underline-offset-10 text-auth-text-primary"},te={class:"text-sm"},oe={class:"font-bold text-auth-countdown"},ae={class:"text-sm text-center"},ne={class:"ml-2 underline cursor-pointer decoration-link-decoration hover:decoration-link-hover-decoration decoration-1 underline-offset-4 text-link hover:text-link-hover"},ve=O({__name:"forgot-password",setup(l){const e=L(),{$apiFetch:c}=P(),{t:r}=D(),o=q(),{e:t}=Q(),a=S(!1),u=S("");E({title:`${r("meta.title.forgot_password")} - ${e.public.app.name}`,meta:[{name:"description",content:"My design project application."}]}),j(()=>u.value=o.form.otp);const{remaining:m}=Y(200,{onComplete(){},onTick(){}}),v=G(()=>{const n=Math.floor(m.value/60),i=m.value%60;return`${n.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}),s=()=>a.value=!0,d=()=>a.value=!1,_=async()=>{if(String(o.form.otp).trim().length>0){s();let n;try{const{apiResponse:i,validError:g}=await c("/api/auth/validateOtp",{method:"POST",body:{otp:o.form.otp}});return g?n=g.forEach(y=>t(y.message)):n=i?H("/auth/update-password"):t(r("validation.bad_otp")),n}catch{}finally{d()}}else t(r("validation.bad_otp"))};return(n,i)=>{const g=K,y=U;return T(),W("div",Z,[p("h2",ee,f(n.$t("page.forgot_password.form_title")),1),p("p",null,[h(f(n.$t("page.forgot_password.intro_msg.part1"))+" ",1),i[2]||(i[2]=p("span",{class:"font-semibold"},"ousmane@gmail.com",-1)),h(". "+f(n.$t("page.forgot_password.intro_msg.part2")),1)]),p("form",{onSubmit:z(_,["prevent"]),class:"flex flex-col mt-4 space-y-4"},[k(g,{identifier:"otp",modelValue:w(u),"onUpdate:modelValue":i[0]||(i[0]=x=>R(u)?u.value=x:null),size:"large","pt:root":"mx-auto",integerOnly:"",onValueChange:i[1]||(i[1]=x=>w(o).updateFormField("otp",x))},null,8,["modelValue"]),p("p",te,[h(f(n.$t("page.forgot_password.resend_code"))+" ",1),p("span",oe,f(w(v)),1)]),k(y,{type:"submit",label:n.$t("button.verify_code"),loading:w(a)},null,8,["label","loading"]),p("p",ae,[h(f(n.$t("page.forgot_password.resend_code_link"))+" ",1),p("span",ne,f(n.$t("page.forgot_password.resend_code_button")),1)])],32)])}}});export{ve as default};
