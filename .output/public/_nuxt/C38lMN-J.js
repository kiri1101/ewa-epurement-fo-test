import{_ as S}from"./DRYY3jEA.js";import{u as $,_ as k}from"./DdbQpEcR.js";import{k as F,m as C,l as N,T as R,r as p,u as B,n as E,f as L,c as f,a as m,t as _,b as u,h as a,q as M,s as P,o as w,v as T}from"./B5jmmgch.js";import{u as A}from"./DNfZ_E1e.js";import"./BXm-dGCd.js";import"./sPKYO-qt.js";import"./B7Gih5hX.js";import"./mIU_V9T5.js";import"./BybXUGIc.js";import"./SczUJWWo.js";const I={class:"w-full mx-auto sm:w-92"},U={class:"pb-4 text-3xl font-bold text-center underline decoration-auth-form-title-decoration decoration-2 underline-offset-10 text-auth-text-primary"},j={key:0,class:"text-xs text-validation-error font-semibold transition duration-200 ease-linear"},Y=F({__name:"update-password",setup(q){const h=E(),{t:g,locale:b}=C(),{e:c}=$(),{$apiFetch:v}=N();R();const t=A(),l=p(!1),d=p(!1),n=p({secret:"",secret_confirm:""});B({title:`${g("meta.title.update_password")} - ${h.public.app.name}`,meta:[{name:"description",content:"My design project application."}]}),L(()=>n.value=t.form);const y=()=>d.value=!0,x=()=>d.value=!1,V=async()=>{if(l.value=t.form.secret!==t.form.secret_confirm,!l.value){y();try{const{apiResponse:e,errResponse:o,validError:i}=await v("/api/auth/update/password",{method:"POST",body:{otp:t.form.otp,secret:t.form.secret,secret_confirm:t.form.secret_confirm,lang:b.value}});if(i&&i.forEach(s=>c(s.message)),e){let s;return String(e.pesake.detail).trim().length>0?s=c(e.pesake.detail):(t.reset(),s=T("/dashboard")),s}}catch{}finally{x()}}};return(e,o)=>{const i=S,s=k;return w(),f("div",I,[m("h2",U,_(e.$t("page.update_password.form_title")),1),m("form",{onSubmit:P(V,["prevent"]),class:"flex flex-col mt-4 space-y-4"},[u(i,{identifier:"new_password",modelValue:a(n).secret,"onUpdate:modelValue":o[0]||(o[0]=r=>a(n).secret=r),placeholder:e.$t("placeholder.new_password"),onValueChange:o[1]||(o[1]=r=>a(t).updateFormField("secret",r))},null,8,["modelValue","placeholder"]),m("div",null,[u(i,{identifier:"confirm_new_password",modelValue:a(n).secret_confirm,"onUpdate:modelValue":o[2]||(o[2]=r=>a(n).secret_confirm=r),placeholder:e.$t("placeholder.confirm_new_password"),onValueChange:o[3]||(o[3]=r=>a(t).updateFormField("secret_confirm",r))},null,8,["modelValue","placeholder"]),a(l)?(w(),f("span",j,_(e.$t("validation.pwd_confirm_failed")),1)):M("",!0)]),u(s,{type:"submit",label:e.$t("button.update_password"),loading:a(d)},null,8,["label","loading"])],32)])}}});export{Y as default};
